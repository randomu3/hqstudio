# Требования: Синхронизация паролей Desktop/Web

## Контекст
Desktop приложение и Web админка используют общий API для авторизации. Необходимо обеспечить единую систему управления паролями.

## Функциональные требования

### FR-1: Обязательная смена пароля при первом входе
- При создании пользователя устанавливается флаг `MustChangePassword = true`
- При входе с этим флагом пользователь должен сменить пароль
- После смены пароля флаг сбрасывается

### FR-2: Сброс пароля администратором
- Администратор может сбросить пароль любого пользователя
- После сброса устанавливается временный пароль и `MustChangePassword = true`
- Пользователь получает уведомление о необходимости смены пароля

### FR-3: Единый API для Desktop и Web
- Endpoint `POST /api/auth/change-password` для смены пароля
- Endpoint `POST /api/users/{id}/reset-password` для сброса (только Admin)
- JWT токен содержит информацию о `MustChangePassword`

## Нефункциональные требования

### NFR-1: Безопасность
- Пароли хешируются через BCrypt
- Минимальная длина пароля: 6 символов
- Защита от перебора: блокировка после 5 неудачных попыток

### NFR-2: UX
- Desktop показывает диалог смены пароля при первом входе
- Web редиректит на страницу смены пароля

## Связанные файлы
- #[[file:HQStudio.API/Controllers/AuthController.cs]]
- #[[file:HQStudio.API/Controllers/UsersController.cs]]
- #[[file:HQStudio.Desktop/Views/Dialogs/ChangePasswordDialog.xaml]]
